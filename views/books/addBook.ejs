<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <%- include('../partials/head.ejs'); %>
    </head>

    <body>
        <!--**********  Preloader start *************-->
        <div id="preloader">
            <div class="sk-three-bounce">
                <div class="sk-child sk-bounce1"></div>
                <div class="sk-child sk-bounce2"></div>
                <div class="sk-child sk-bounce3"></div>
            </div>
        </div>
        <!--******** Preloader end *********-->

        <!--******** Main wrapper start ******-->
        <div id="main-wrapper">
            <!--********** Nav header start *********-->
            <div class="nav-header">
                <a href="index.html" class="brand-logo">
                    <img class="logo-abbr" src="/images/logo.png" alt="" />
                    <img class="logo-compact" src="/images/logo-text.png" alt="" />
                    <img class="brand-title" src="/images/logo-text.png" alt="" />
                </a>

                <div class="nav-control">
                    <div class="hamburger"><span class="line"></span><span class="line"></span><span class="line"></span></div>
                </div>
            </div>
            <!--**********  Nav header end *********-->

            <!--****** 
            Header start ************-->
            <%- include('../partials/header.ejs'); %>

            <!--********** Header end ti-comment-alt*********-->

            <!--********** Sidebar start *********-->
            <%- include('../partials/sidebar.ejs'); %>

            <!--********** Sidebar end ********-->

            <!--********** Content body start *********-->
            <div class="content-body">
                <!-- row -->
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12">
                            <form id="app-form" enctype="multipart/form-data">
                                <!-- <form id="app-form"> -->
                                <div class="row">
                                    <div class="col-lg-9">
                                        <div class="card-box text-center">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Book Title</label>
                                                        <div class="col-sm-8">
                                                            <input type="text" tabindex="1" class="form-control" placeholder="ex:'book title'" name="item_name" id="item_name" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">ISBN NO</label>
                                                        <div class="col-sm-8">
                                                            <input type="text" tabindex="2" class="form-control" name="isbn" placeholder="ex:'1253456789'" id="isbn" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Author</label>
                                                        <div class="col-sm-8">
                                                            <input type="text" tabindex="3" class="form-control" placeholder="ex:'author name'" name="author_name" id="author_name" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Pages</label>
                                                        <div class="col-sm-8">
                                                            <input type="text" tabindex="4" class="form-control" placeholder="ex:'120'" name="pages" id="pages" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Edition</label>
                                                        <div class="col-sm-8">
                                                            <input class="form-control" tabindex="5" id="edition" placeholder="ex:'2014'" name="edition" data-toggle="datepicker" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Language</label>
                                                        <div class="col-sm-8">
                                                            <input type="text" tabindex="6" class="form-control" placeholder="ex:'English'" name="language" id="language" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Item type</label>
                                                        <div class="col-sm-8">
                                                            <select name="type" class="form-control" id="type" tabindex="7" aria-hidden="true" required>
                                                                <option>Choose one</option>
                                                                <option value="Book">Book</option>
                                                                <option value="Magazine">Magazine</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Category</label>
                                                        <div class="col-sm-8">
                                                            <select name="category_id" tabindex="8" class="form-control" id="category_id" aria-hidden="true" required>
                                                                <option value="0">Choose one</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Cost</label>
                                                        <div class="col-sm-8">
                                                            <input type="text" tabindex="9" class="form-control" placeholder="ex:'Free'" name="status" id="status" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Description</label>
                                                        <div class="col-sm-8">
                                                            <textarea tabindex="10" class="form-control" placeholder="ex:'enter description'" name="desc" id="desc"></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-4 col-form-label text-left">Item file</label>
                                                        <div class="col-sm-8">
                                                            <input id="file" type="file" tabindex="11" class="form-control border-0" name="file" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3">
                                        <div class="card-box text-center">
                                            <p class="text-left">Upload PDF IMAGE</p>
                                            <!-- Uploaded image area-->
                                            <div class="image-area">
                                                <img id="imageResult" src="#" alt="" class="img-fluid avatar-xl img-thumbnail shadow-sm mx-auto d-block" style="width: 250; height: 250" />
                                            </div>
                                        </div>
                                        <input type="hidden" name="oldImg" value="1.jpg" />
                                        <input id="token" type="hidden" />
                                        <div class="input-group">
                                            <input id="upload" type="file" tabindex="12" onchange="readURL(this);" class="form-control border-0" name="img" value="1.jpg" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-12">
                                        <div class="m-t-20 text-center">
                                            <button class="btn btn-outline-primary submit-btn" tabindex="13" type="submit">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--****** Content body end ******-->
        </div>
        <!--****** Main wrapper end ******-->
        <!--****** Scripts ******-->
        <%- include('../partials/scripts.ejs'); %>

        <script src="/js/ajax/userConfig.js"></script>
        <script src="/js/ajax/ajaxAddBook.js"></script>
        <script>
            $(document).ready(function () {
                var userData = JSON.parse(localStorage.getItem("userData"));
                $("input#email").val(userData.email);
                $("input#role").val(userData.role);
                $("input#token").val(userData.token);
                $('[data-toggle="datepicker"]').datepicker({
                    format: "yyyy",
                    autoHide: true,
                });
                var input = document.getElementById("upload");
                var infoArea = document.getElementById("upload-label");
                $("#upload").change(function (event) {
                    var input = event.srcElement;
                    var fileName = this.val;
                    infoArea.textContent = "File name: " + fileName;
                });
                $("#app-form").submit(function (e) {
                    e.preventDefault();
                    var form = $(this);
                    var formData = new FormData(this);
                    $.ajax({
                        type: "POST",
                        url: "/books/add-book",
                        // headers: { "x-access-token": userData.token },
                        data: formData,
                        processData: false,
                        contentType: false,
                        success: function (response) {
                            customAlert(response);
                        },
                        error: function (response) {
                            console.log(response);
                            // customAlert(response.responseJSON);
                        },
                    });
                });
            });

            function readURL(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $("#imageResult").attr("src", e.target.result);
                    };
                    reader.readAsDataURL(input.files[0]);
                }
            }
            $(function () {
                $("#upload").on("change", function () {
                    readURL(input);
                    this.val;
                });
            });
            /*  ==========================================
                SHOW UPLOADED IMAGE NAME
            * ========================================== */
            var input = document.getElementById("upload");
            var infoArea = document.getElementById("upload-label");
            input.addEventListener("change", showFileName);
            function showFileName(event) {
                var input = event.srcElement;
                var fileName = input.files[0].name;
                infoArea.textContent = "File name: " + fileName;
            }
            function customAlert(params) {
                Swal.fire({
                    icon: params.type,
                    title: params.title,
                    html: `<div class="mb-2">${params.message} </div><a class=" btn btn-outline-${params.btnType}" href="${params.link}">${params.link_text}</a>`,
                    showConfirmButton: false,
                });
            }
        </script>
    </body>
</html>
